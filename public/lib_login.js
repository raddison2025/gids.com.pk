function $(e){var t=document.forms[0],n=t[e];return n||document.getElementById(e)}function setCookie(e,t){var n=new Date;n.setTime(n.getTime()+31536e6);var r="; expires="+n.toGMTString();document.cookie=e+"="+escape(t)+r}function getCookie(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var r=t[n].split("=");if(e==r[0].trim())return unescape(r[1])}return null}function removeCookie(e){document.cookie=e+"=0; expires=Wed, 16 Apr 1980 21:50:51 GMT;"}function cookiesAllowed(){return setCookie("cookieTest","cookiesEnabled"),"cookiesEnabled"==getCookie("cookieTest")&&(removeCookie("cookieTest"),!0)}function urlRedirect(e,t){if(e){var n=(e.replace(/:.*/,""),e.replace(/[^:]*:/,"")),r=document.location.href.replace(/https?:\/*/,"").replace(/\/*\?.*/,"").replace(/:[0-9]+.*/,"").replace(/\/+/,"");if(-1!=e.indexOf("%%*%%"))var o=t+"://"+r+":"+n+"/";else var o=t+"://"+e;return o+"?m="+("https"==t?"secure":"plain")}}function preloaderDone(e){if(!document)return!1;var t=document.body,n=document.getElementById("preloader_text"),r=document.getElementById("preloader_content");if(!t||!n||!r)return!1;cookiesAllowed()||($("preloader_text").style.display="none",$("preloader_content").style.display="none",$("visibleCookieContainer").style.display="block");var o=$("username"),i=$("password"),a=$("domainname"),s=$("rememberLogin"),c=getCookie("AXIWMRememberLogin");if(c&&a){var u=c.split("@");if(u[0])var l=u[0];if(u[1])var m=u[1]}else var l=c;s&&l&&(s.checked=!0);var d=o;if(l){o.value=l;var d=i}if(m)for(var f=0;f<a.options.length;f++)if(m==a.options[f].value){a.selectedIndex=f;break}var p=document.getElementById("secureLinkId"),v=document.getElementById("plainLinkId");p&&(p.href=urlRedirect(preloaderDone.SecureUrl,"https")),v&&(v.href=urlRedirect(preloaderDone.SecureUrl,"http")),$("ajax_login")&&($("ajax_login").onclick=function(){switchInterface(e,"ajax")}),t.removeChild(n),r.style.display="block";var g=document.forms.loginForm;if(!g||!g.username)return!1;d.focus()}function formValidate(){var e=document.forms.loginForm;if(!e||!e.username||!e.password)return!1;var t=null;if(""==e.username.value||""==e.username.value.replace(/[\r\n\t ]+/g,"")?(e.username.className="input_error",t=e.username):(e.username.className="",t==e.username&&(t=null)),""==e.password.value||""==e.password.value.replace(/[\r\n\t]+/g,"")?(e.password.className="input_error",t||(t=e.password)):(e.password.className="",t==e.password&&(t=null)),t)return document.getElementById("error_msg").innerHTML="Username and / or password are empty.",t.focus(),!1;var n=$("rememberLogin"),r=$("username"),o=$("domainname"),i=r.value;return o&&o.options[o.selectedIndex]&&(i+="@"+o.options[o.selectedIndex].value),n&&n.checked?setCookie("AXIWMRememberLogin",i):removeCookie("AXIWMRememberLogin"),Captcha.isValid(function(e,t){!e&&t&&Captcha.form.submit()}),!1}function validateMobileForm(){return Captcha.isValid(function(e,t){!e&&t&&Captcha.form.submit()}),!1}function switchInterface(e,t,n){if(!cookiesAllowed())return!1;var r=getCookie(e);if(r){var o=r.split("#");ajax_interface=o[0],secure_interface=o[1]}else ajax_interface=n?"true":"false",secure_interface="false";switch(t){case"standard":setCookie(e,"false#"+secure_interface);break;case"ajax":setCookie(e,"true#"+secure_interface);break;case"secure":setCookie(e,ajax_interface+"#true");break;case"plain":setCookie(e,ajax_interface+"#false")}}function switchLanguage(e,t){if(!cookiesAllowed())return!1;setCookie(e,t)}function saveLogin(e){""!=e.trim()&&setCookie("username",e)}function resetLogin(){removeCookie("username")}function fillLogin(){var e=getCookie("username");e&&"0"!=e&&(document.getElementById("username").value=e,document.getElementById("rememberLogin").checked=!0),checkEmptyFields()}function fillRememberMe(){var e=getCookie("AXIWMRememberLogin");if(e){var t=e.split("@");if(t[0])var n=t[0];if(t[1]){t[1]}}else var n=e;"true"===n&&(n="");var r=document.getElementById("username"),o=document.getElementById("rememberLogin");void 0!==n&&n&&(console.log("RememberLogin","RESTORE",n),r.value=n,o.checked=!0),o.form.onsubmit=function(){o.checked?(console.log("RememberLogin","ON",r.value),setCookie("AXIWMRememberLogin",r.value)):(console.log("RememberLogin","OFF"),removeCookie("AXIWMRememberLogin"))}}function manageLoginData(){if(document.getElementById("rememberLogin")&&1==document.getElementById("rememberLogin").checked){saveLogin(document.getElementById("username").value)}else resetLogin()}function checkEmptyFields(e){e=e||null;var t=window.setInterval(function(){var e=document.getElementById("password");e.value&&(e.className+=" notEmpty",window.clearInterval(t))},100);if("changePassword"==e)var n=window.setInterval(function(){var e=document.getElementById("newpassword");e.value&&(e.className+=" notEmpty",window.clearInterval(n))},100),r=window.setInterval(function(){var e=document.getElementById("retypePassword");e.value&&(e.className+=" notEmpty",window.clearInterval(r))},100)}String.prototype.trim=function(){return this.replace(/^[ \t]*/,"").replace(/[ \t]$/,"")};var Captcha={form:null,isRequired:null,isRequiredQueried:!1,init:function(e){this.form=document.forms.loginForm||document.forms[0],this.form&&this.form.username&&(this.form.username.addEventListener("change",this.onChange.bind(this)),e&&e.onShow&&(this.onShow=e.onShow))},onChange:function(e){this.isRequired=null,this.isRequiredQueried=!1,this.queryIsRequired()},isValid:function(e){if(!this.isRequiredQueried)return this.queryIsRequired(function(t){if(e)return t?e(t):void e(!1,Captcha.isValid())}),!1;if(!this.isRequired)return!e||e(!1,!0);var n="none"!=$("captcha-text").style.display,r=!!this.form.captchaText.value;if(n&&!r)return document.getElementById("error_msg").innerHTML=t("Please fill in the CAPTCHA field."),Captcha.focus(),!!e&&e(!1,!1);if(r){var o=getCookie("_captchaid");return o&&(this.form.captchaId.value=o),!e||e(!1,!0)}return!!e&&e(!1,!1)},queryIsRequired:function(e){var n="/captcha.hsp?action=isRequired&username="+this.form.username.value,r=this;new Ajax.Request(n,{method:"GET",onCreate:function(){$$(".submit").each(function(e){$(e).setAttribute("disabled",!0)})},onComplete:function(e){$$(".submit").each(function(e){$(e).removeAttribute("disabled")})},onSuccess:function(n,o){if(!n.responseText)return document.getElementById("error_msg").innerHTML=t("Unable to connect to server!"),!!e&&e(!0);var i=n.responseText.evalJSON();if(0!=i.status)return document.getElementById("error_msg").innerHTML=t("Login failed. Try again."),!!e&&e(!0);r.isRequired=i.isRequired,r.isRequiredQueried=!0,i.isRequired&&r.show(),e&&e(!1)},onFailure:function(n){document.getElementById("error_msg").innerHTML=t("Unable to connect to server!"),e&&e(!0)},onException:function(n,r){document.getElementById("error_msg").innerHTML=t("Unable to connect to server!"),e&&e(!0)}})},show:function(){$$("#captcha-img img")[0].src="/captcha.hsp?action=show&username="+this.form.username.value,$("captcha-img").style.display="",$("captcha-text").style.display="",Captcha.focus(),this.onShow&&this.onShow()},focus:function(){this.form.username.value&&this.form.password.value&&this.form.captchaText.focus()}};document.cookie="webmailSession=0; expires=Fri, 31 Dec 1999 23:59:59 GMT;";